<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>登录 - DApp</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<div class="login-container">
    <div class="logo-section">
        <img class="logo-img" src="https://raw.githubusercontent.com/FFAI888/55555555/main/img/0E0CB292-E014-42D1-B11B-5B04BCA492F3.jpeg" alt="logo">
        <div class="logo-text-wrap">
            <h1>融 链</h1>
            <p>RongChain</p>
        </div>
    </div>
    <button id="connectWalletBtn" class="wallet-btn">连接钱包</button>
    <div id="walletAddress" class="wallet-address">钱包未连接</div>
</div>

<script>
const connectBtn = document.getElementById('connectWalletBtn');
const walletAddressDiv = document.getElementById('walletAddress');

async function connectWallet() {
    if (window.ethereum) {
        try {
            const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            const account = accounts[0];
            // 隐藏中间部分
            const start = account.slice(0,6);
            const end = account.slice(-4);
            const hiddenAccount = start + '...' + end;
            walletAddressDiv.innerText = '已连接钱包: ' + hiddenAccount;
            // 连接成功跳转首页
            setTimeout(() => {
                window.location.href = 'index.html?account=' + account;
            }, 800);
        } catch (err) {
            walletAddressDiv.innerText = '连接失败';
            console.error(err);
        }
    } else {
        alert('请安装 MetaMask 或其他以太坊钱包插件！');
    }
}

connectBtn.addEventListener('click', connectWallet);
</script>

</body>
</html>
